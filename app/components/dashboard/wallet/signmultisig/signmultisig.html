<div ng-if="$ctrl.signMultisigModel.values.transactions.length > 0">
	<br>
	<div class="alert alert-info">
		<translate>You have {{$ctrl.signMultisigModel.values.transactions.length}} pending transactions to sign.</translate>
		<a href="#" ng-click="$ctrl.openModal()" translate>Sign now</a>
	</div>
</div>

<!-- Sign modal -->
<modal mid="signModal" content="true">
	<div class="modal-content">
		<wizard name="signMultisig" template="/shared/templates/angular-wizard/wizard.html" indicators-position="top" class="modal-body">
			<wz-step wz-title="{{ $ctrl.signMultisigModel.step1.title.main }}" wz-heading-title="{{ $ctrl.signMultisigModel.step1.title.heading }}">
				<p class="padding-top-bottom-10 text-center" translate translate-n="$ctrl.signMultisigModel.values.transactions.length" translate-plural="There are {{$count}} transactions to sign.">There is 1 transaction to sign.</p>
				<table class="table">
					<thead class="separator">
						<tr>
							<th class="text-center">
								<translate class="hidden-xs">Organization</translate>
								<translate class="hidden-lg hidden-md hidden-sm">Org.</translate>
							</th>
							<th class="text-center">
								<translate>Value</translate> [{{null|money}}]
							</th>
							<th class="text-center hidden-xs" translate>Date</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="tx in $ctrl.signMultisigModel.values.transactions">
							<td class="text-center text-break-all">{{tx.from}}</td>
							<td class="text-center">{{tx.value|money:'full':false}}</td>
							<td class="text-center  hidden-xs">{{tx.time|date}}</td>
							<td class="text-center">
								<button class="btn btn-sm btn-default" ng-click="$ctrl.signMultisigModel.step1.selectTransaction(tx)">
									<i class="fa fa-pencil"></i>
									<translate class="hidden-xs">Details</translate>
								</button>
							</td>
						</tr>
					</tbody>
				</table>
				<hr>

				<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
						<a type="button" class="btn btn-danger btn-xs-block" data-dismiss="modal" translate>Close</a>
					</div>
				</div>
			</wz-step>
			<wz-step wz-title="{{ $ctrl.signMultisigModel.step2.title.main }}" wz-heading-title="{{ $ctrl.signMultisigModel.step2.title.heading }}">
				<div class="row">
					<div class="col-xs-12">
						<response-messages message="{{$ctrl.signMultisigModel.step2.error}}"></response-messages>
					</div>
				</div>

				<table class="table">
					<tr>
						<td translate>From</td>
						<td class="text-break-all"><a href="/user/{{$ctrl.signMultisigModel.values.selected.from}}" target="_blank">{{$ctrl.signMultisigModel.values.selected.from}}</a></td>
					</tr>
					<tr>
						<td translate>From wallet</td>
						<td class="text-break-all">{{$ctrl.signMultisigModel.values.selected.wallet.label}}</td>
					</tr>
					<tr>
						<td translate>Value</td>
						<td>{{$ctrl.signMultisigModel.values.selected.value|money:'full'}}</td>
					</tr>
					<tr>
						<td translate>Fee</td>
						<td>{{$ctrl.signMultisigModel.values.selected.fee|money:'full'}}</td>
					</tr>
					<tr>
						<td translate>Creation date</td>
						<td>{{$ctrl.signMultisigModel.values.selected.time|date:'medium'}}</td>
					</tr>
					<tr ng-if="$ctrl.signMultisigModel.values.selected.ror != null">
						<td translate>Refund to</td>
						<td><a href="/user/{{self.signMultisigModel.values.rors[$ctrl.signMultisigModel.values.selected.ror].from}}" target="_blank">{{self.signMultisigModel.values.rors[$ctrl.signMultisigModel.values.selected.ror].from}}</a></td>
					</tr>
					<tr ng-if="$ctrl.signMultisigModel.values.selected.ror != null">
						<td translate>Refund invoice</td>
						<td><a href="{{self.signMultisigModel.values.rors[$ctrl.signMultisigModel.values.selected.ror].documents[0]|media}}" target="_blank"><i class="fa fa-external-link"></i> View document</a></td>
					</tr>
					<tr>
						<td translate>To</td>
						<td class="text-center text-ellipsis" >
							<a
								href="javascript:void(0)"
								tooltip
								tooltip-content="{{ 'Click to copy the address' | translate }}"
								copy-to-clipboard="{{$ctrl.signMultisigModel.values.selected.to}}">{{$ctrl.signMultisigModel.values.selected.to}}</a>
					</tr>
					<tr>
						<td translate>Signatures</td>
						<td>{{$ctrl.signMultisigModel.values.selected.signers.length}} of {{$ctrl.signMultisigModel.values.selected.n}}</td>
					</tr>
					<tr>
						<td translate>Description</td>
						<td class="text-break-all">{{$ctrl.signMultisigModel.values.selected.description}}</td>
					</tr>
				</table>
				<div ng-if="$ctrl.signMultisigModel.values.hardware">
					<br>
					<ledger-wait config="{{ $ctrl.signMultisigModel.step2.ledgerWaitStatus }}" exec="$ctrl.signMultisigModel.step2.sign"></ledger-wait>
				</div>
				<div ng-if="!$ctrl.signMultisigModel.values.hardware">
					<span ng-if="!$ctrl.signMultisigModel.values.useBackup" ng-init="showpassphrase = true">
						<p>
							<translate>Insert your passphrase (or click</translate> <a ng-click="$ctrl.signMultisigModel.values.useBackup = true;" href="" translate>here</a>
							<translate>to sign with your backup file)</translate>:
						</p>
						<input class="form-control" ng-attr-type="{{ showpassphrase ? 'text' : 'password' }}" ng-model="$ctrl.signMultisigModel.values.mnemonic" value="{{$ctrl.signMultisigModel.values.mnemonic}}" />
						<div class="text-right">
							<a href="" ng-click="showpassphrase = !showpassphrase">
								<span ng-if="showpassphrase" translate>Hide passphrase</span>
								<span ng-if="!showpassphrase" translate>Show passphrase</span>
							</a>
						</div>
					</span>
					<span ng-if="$ctrl.signMultisigModel.values.useBackup">
						<p>
							<translate>Load your backup file (or click</translate> <a ng-click="$ctrl.signMultisigModel.values.useBackup = false;" href="" translate>here</a>
							<translate>to sign with your passphrase)</translate>:
						</p>
						<input type="file" accept="application/json" class="form-control upload" ngf-select="$ctrl.signMultisigModel.step2.loadBackupFile($file);"></input>
						<translate>Backup password</translate>:
						<br>
						<input type="password" class="form-control" value="" ng-model="$ctrl.signMultisigModel.values.backup.password" />
					</span>
				</div>

				<hr>

				<div class="row">
					<div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 text-lg-left text-md-left text-sm-left text-xs-center">
						<button type="button" class="btn btn-danger btn-xs-block" data-dismiss="modal" translate>Close</button>
					</div>
					<div class="col-lg-8 col-md-8 col-sm-8 col-xs-12 text-lg-right text-md-right text-sm-right text-xs-center margin-xs-top-5">
						<button type="button" class="btn btn-danger btn-xs-block" ng-click="$ctrl.signMultisigModel.step2.refuse()"><i class="fa fa-times"></i>
							<translate>Refuse</translate>
						</button>
						<button type="button" class="btn btn-default btn-xs-block margin-xs-top-5" loading="$ctrl.signMultisigModel.step2.loading" ng-click="$ctrl.signMultisigModel.step2.sign()"><i class="fa fa-pencil"></i>
							<translate>Sign</translate>
						</button>
					</div>
				</div>
			</wz-step>
			<wz-step wz-title="{{ $ctrl.signMultisigModel.step3.title.main }}" wz-heading-title="{{ $ctrl.signMultisigModel.step3.title.heading }}">
				<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center completed-img">
						<img src="/media/completed-green.png">
					</div>
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center margin-top-20 completed-text">
						<p ng-if="$ctrl.signMultisigModel.values.refused" translate>You have successfully refused to sign this transaction.</p>
						<p ng-if="!$ctrl.signMultisigModel.values.refused" translate>The transaction has been signed.</p>
					</div>
				</div>
				<div class="row">
					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
						<button type="button" class="btn btn-danger btn-xs-block" data-dismiss="modal" translate>Close</button>
					</div>
				</div>
			</wz-step>
		</wizard>
	</div>
</modal>